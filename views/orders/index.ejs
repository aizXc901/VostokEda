<h2>Orders</h2>

<div class="mb-3">
    <a href="/orders/new" class="btn btn-primary">Add New Order</a>
</div>

<div class="row">
    <div class="col-md-12">
        <% if (orders.length === 0) { %>
            <div class="alert alert-info">No orders found. <a href="/orders/new">Create one now</a>.</div>
        <% } else { %>
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Order Number</th>
                        <th>Event</th>
                        <th>Date</th>
                        <th>Total Amount</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% orders.forEach(order => { %>
                        <tr>
                            <td><%= order.id %></td>
                            <td><%= order.orderNumber %></td>
                            <td><%= order.Event.name %></td>
                            <td><%= new Date(order.orderDate).toLocaleDateString() %></td>
                            <td>
                                <% 
                                    let totalAmount = 0;
                                    if (order.OrderItems) {
                                        order.OrderItems.forEach(item => {
                                            totalAmount += item.quantity * parseFloat(item.price);
                                        });
                                    }
                                %>
                                <%= totalAmount.toFixed(2) %>
                            </td>
                            <td>
                                <a href="#" class="btn btn-sm btn-outline-info">Details</a>
                            </td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        <% } %>
    </div>
</div>